from openai import OpenAI
from pydantic import BaseModel
import config

client = OpenAI(api_key=config.OPENAI_API_KEY)

class KeyKnowledgeResponse(BaseModel):
    key_knowledge: str

def key_knowledge_generator(question):
    completion = client.beta.chat.completions.parse(
        model="gpt-4o",
        response_format=KeyKnowledgeResponse,
        messages=[
            {
                "role": "system", 
                "content": """
**역할**
너는 ##수강생 문의## 해결에 필요한 ##핵심 지식##을 뽑는 역할이야.

**답변 예시**
##수강생 문의##
• 마지막(8주차) 실습 과제 제출 마감 조정
8주차 실습 과제 제출 마감: 2024년 6월 11일(화요일) 오후 1시
금 1-2교시 수업을 듣고있는 경영학과 24학번 2023120349 이승재입니다.
공지를 늦게 확인하여 코들 제출을 방금 완료하였는데 감점이 있을까요??

##핵심 지식##
공지를 늦게 확인해 8주차 과제를 늦게 제출한 경우 감점이 발생하는지 여부
--
##수강생 문의##
안녕하세요 2024120376 임해든 학생입니다.
3/29일에 출석 인정이 안되어 있어 연락드립니다. 제가 항상 시계에 알람을 맞춰두고 출석하기 버튼을 누르고 줌수업에 들어갔기에 제가 버튼을 안누르지는 않았던 것 같습니다. 그때 줌 수업도 들어가서 끝까지 듣고 실습시간에 질문도 했었는데 출석 인정이 안될까요? 줌수업에는 정해진 시간에 맞춰서 들어갔을 것입니다. 줌 로그인 기록과 제가 실습시간에 했던 질문을 근거로 출석 인정 해주실 수 있을까요? 3/29일에 조교님께 코들 오류로 메일도 보냈었습니다 ㅜㅜ 부탁드립니다

##핵심 지식##
3월 29일의 출석이 인정되지 않아 Zoom 수업 참여 기록과 실습시간의 질문 기록을 바탕으로 출석 인정이 가능한지 여부
--
##수강생 문의##
안녕하세요. 2024120272 이현지 SW프로그래밍 출석 문의 드립니다.
오늘 배부된 출석 점수 자료 확인해보니 지각이 6회 측정된 것 확인했습니다.
정규 수업시간 (9:00~11:45) 5분 전 5분 후 이내에 블랙보드 출석하였는데 10시 반 정도 기준으로 이후에 출석한 것은 지각처리되는 줄 모르고 11:45분 기준으로 출석 체크했습니다... 수업 시간 중 안내하셨다면 제가 착각하거나 놓친 것 같습니다...
출석 인정 가능한지 문의드립니다.
감사합니다.

##핵심 지식##
출석 점수에서 10시 반 이후의 출석이 지각 처리된다는 사실을 모르고 11시 45분 기준으로 체크했으므로 출석으로 인정이 가능한지 여부
--
##수강생 문의##
안녕하세요 조교님 SW 수업 듣는 경영학과 한유비 입니다.
다름이 아니라 8주차 실습 기한이 코들에는 6/13일까지라고 되어있어서 어제 제출했는데 공지사항에는 6/11까지라고 되어있던 걸 제가 확인을 못했습니다.. 혹시 정상참작 가능한가요 ㅠㅠ 제발…

##핵심 지식##
코들과 공지사항의 8주차 실습 과제 제출 기한 상이에 의한 착오로 인해 늦게 제출한 경우 정상참작이 가능한지 여부
--
##수강생 문의##
안녕하십니까 조교님 김중헌교수님 sw프로그래밍의 기초를 수강하는 경영학과 강태완 이라고 합니다.
다름이 아니라 코들 회원가입까지는 완료하였는데 교실에 가입하려면 초대코드가 필요하다고 합니다.
초대코드는 수업시간에 배부받을수 있는 것인지 추가 공지사항이 있는 것인지 알고 싶습니다.
감사합니다.
강태완 올림.

##핵심 지식##
코들 교실 가입을 위한 초대코드는 수업시간에 배부받을 수 있는지에 대한 지식
--
##수강생 문의##
안녕하세요, 2024120376 임해든입니다
2주차 실습을 전부 완료했고 제출하기도 눌렀는데 스튜디오 활동에 진도 퍼센트가 안 뜨고 "활동을 완료해주세요"라고 뜹니다. 2문제 다 정답을 맞추었고 제출도 했음에도 계속 이러한 상태가 지속되고 있습니다. 정상적으로 제출되었는지 확인해주실 수 있나요?

##핵심 지식##
2주차 실습에서 제출을 했음에도 스튜디오 활동에 진도 퍼센트가 안 뜨는 상태가 정상적인 제출 상태인지에 대한 지식
--
##수강생 문의##
안녕하세요 2024120310 김수민입니다.
SW 2주차 과제 관련하여 문의드립니다.
2주차 과제 두 개 모두 정답입니다가 나왔는데 스튜디오 활동이 100%가 아니고 50%가 나옵니다.
혹시 과제는 모두 마쳤는데 스튜디오 활동이 50%가 나온다면 불이익이 있나요??

##핵심 지식##
2주차 과제 모두 정답을 맞춘 상태이나 스튜디오 활동이 100%가 아닌 50%가 나오는데 불이익이 있는지에 대한 지식
--
##수강생 문의##
안녕하세요. 김중헌 교수님의 [SW 프로그래밍의 기초]를 수강하고 있는 2024120323 노시현입니다.
다름이 아니라 제가 3월 29일에 Blackboard 출석확인자율화 버튼을 누르는 것을 깜빡하여, 이를 강의를 다 들은 후 정규 강의시간이 지나고 난 후에야 알아차리고 말았습니다. 혹시 Zoom 로그인 기록만으로도 출석 인정을 받을 수 있을지 이에 여쭈어보고 싶어 메일 드립니다. 다시는 이런 일이 없도록 하겠습니다.
감사합니다.

##핵심 지식##
출석확인자율화 버튼을 누르는 것을 깜빡한 상황에서 Zoom 로그인 기록만으로 출석 인정을 받을 수 있는지에 대한 지식

---------------------------
답변할 때 번호 매기지 말고 한 문장으로 말해.
<~~~~~~에 대한 지식> 이런식으로.
"""
            },
            {
                "role": "user", 
                "content": question
            }
        ]
    )
    key_knowledge = completion.choices[0].message.parsed.key_knowledge
    return key_knowledge
